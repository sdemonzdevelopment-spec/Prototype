      - name: Install Android SDK + NDK (2024-safe)
        run: |
          # <-- THIS INDENTATION IS REQUIRED
          set -e
          export ANDROID_SDK_ROOT="$RUNNER_TEMP/android-sdk"
          mkdir -p "$ANDROID_SDK_ROOT/cmdline-tools"
          cd "$ANDROID_SDK_ROOT/cmdline-tools"
          
          echo "Downloading latest cmdline-tools..."
          curl -o tools.zip -L https://dl.google.com/android/repository/commandlinetools-linux-11076708_latest.zip
          unzip -qq tools.zip -d ./tmp
          mv ./tmp/cmdline-tools ./latest
          
          # Add the new tools to the PATH for *this step*
          export PATH="$ANDROID_SDK_ROOT/cmdline-tools/latest/bin:$PATH"
          
          echo "Accepting SDK licenses..."
          # FIX 1: Run license acceptance as a separate, dedicated command.
          yes | sdkmanager --licenses --sdk_root="$ANDROID_SDK_ROOT"
          
          echo "Installing SDK components..."
          # FIX 2: Install packages *without* the 'yes' pipe, as licenses are already accepted.
          sdkmanager --sdk_root="$ANDROID_SDK_ROOT" \
            "platform-tools" \
            "platforms;${ANDROID_PLATFORM}" \
            "build-tools;${BUILD_TOOLS}" \
            "ndk;${NDK_VERSION}"
            
          echo "ANDROID_SDK_ROOT=$ANDROID_SDK_ROOT" >> $GITHUB_ENV
